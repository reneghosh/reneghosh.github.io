<!doctype html>
<html>
  <head>
    <title>Paged text</title>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Slab|Shrikhand" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="d3.min.js"></script>
    <script src="odyssey.js"></script>
    <style>
    #text {
      width: 30em;
      font-family: Georgia;
      font-size: 18px;
    }
    </style>
  </head>
  <body>
    <svg xmlns="http://www.w3.org/2000/svg" id="graphic" width="700" height="1500">
    <style>
    .text {
      font-family: Georgia;
      font-size: 18px;
    }
    </style>
    </svg>
    <div id="text" style="visibility: hidden"></div>
  </body>
  <script>
    var start_time = new Date().getTime();
    var positions = [];
    d3.select("#text").selectAll("p")
      .data(text)
      .enter()
      .append("p")
      .attr("id", function(d,i) { return "para"+i})
      .each(function (d,i){
        var line = d;
        var that = d3.select(this);
        var words = line.split(" ");
        d3.select(this).selectAll("span")
          .data(words)
          .enter()
          .append("span")
          .text(function(d){ return d+" "})
          .each(function(d,i){
            var bounds = d3.select(this).node().getBoundingClientRect();
            positions.push([d,bounds.x, bounds.y]);
          })
      })
      .remove();
    var end_time = new Date().getTime();
    console.log("Preparation time: "+(end_time-start_time)/1000);
    var start_time2 = new Date().getTime();
    d3.select("svg").append("g").attr("id", "view");
    d3.select("#view").selectAll("text")
      .data(positions)
      .enter()
      .append("text")
      .attr("x", function(d){return d[1]})
      .attr("y", function(d){return d[2]})
      .text(function(d){return d[0]});
    var end_time2 = new Date().getTime();
    console.log("Presentation time: "+(end_time2-start_time2)/1000);
    console.log("Total time: "+(end_time2-start_time)/1000);
    var counter = 0;
    function scroll_it(){
      if (counter<10){
        d3.selectAll("#view").each(function(d,i){
          var bounds = d3.select(this).node().getBBox();
          d3.select(this)
            .transition().duration(1000)
            .attr("y", bounds.y-10);
        });
        counter += 1;
        setTimeout(scroll_it, 1000);
      }
    }
    /*scroll_it();*/
  </script>
</html>
